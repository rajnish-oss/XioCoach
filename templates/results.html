<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Analysis Results</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.12.16/dist/framer-motion.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Custom Markdown Styling */
        .markdown-content h1 { font-size: 2.25rem; font-weight: 700; margin-bottom: 1rem; color: #1e3a8a; }
        .markdown-content h2 { font-size: 1.875rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem; color: #1e40af; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.25rem; }
        .markdown-content h3 { font-size: 1.5rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 0.5rem; color: #1d4ed8; }
        .markdown-content p { margin-bottom: 1rem; line-height: 1.625; color: #374151; }
        .markdown-content ul { list-style-type: disc; margin-left: 1.5rem; margin-bottom: 1rem; }
        .markdown-content li { margin-bottom: 0.5rem; color: #374151; }
        .markdown-content strong { font-weight: 700; color: #111827; }
        .markdown-content hr { margin: 2rem 0; border: 0; border-top: 1px solid #e5e7eb; }
        .markdown-content blockquote { border-left: 4px solid #3b82f6; padding-left: 1rem; font-style: italic; color: #4b5563; margin-bottom: 1rem; }
        
        /* Hide scrollbar but keep functionality */
        #result::-webkit-scrollbar { width: 6px; }
        #result::-webkit-scrollbar-thumb { background-color: #d1d5db; border-radius: 10px; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-blue-100 min-h-screen flex items-center justify-center p-4">
    
    <div id="container" class="bg-white rounded-xl shadow-2xl p-8 max-w-4xl w-full my-8">
        <h1 class="text-4xl font-bold mb-6 text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-blue-400">
            Resume Analysis Results
        </h1>

        <div id="result" class="bg-gray-50 rounded-lg p-8 border border-gray-200 overflow-auto max-h-[75vh]">
            <div id="markdown-container" class="markdown-content"></div>
            
            <div id="raw-content" style="display: none;">{{ resume_analysis }}</div>
        </div>

        <div class="mt-8 flex justify-between">
            <a href="/" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition duration-200 ease-in-out shadow-md">
                Go Back
            </a>
            <a href="/ask" class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 transition duration-200 ease-in-out shadow-md">
                Ask a Question
            </a>
        </div>
    </div>

    <script>
        // 1. Initialize Markdown Rendering
        const rawContent = document.getElementById('raw-content').innerText;
        const markdownContainer = document.getElementById('markdown-container');

        // Logic to remove server logs (127.0.0.1...) if they exist in the string
        const cleanContent = rawContent.split(/[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}/)[0];

        // Render the cleaned markdown
        markdownContainer.innerHTML = marked.parse(cleanContent);

        // 2. Framer Motion Animations
        const { motion } = window.Motion;

        motion(document.getElementById('container'), {
            initial: { opacity: 0, y: 30 },
            animate: { opacity: 1, y: 0 },
            transition: { duration: 0.6 }
        });

        motion(document.getElementById('result'), {
            initial: { opacity: 0, scale: 0.98 },
            animate: { opacity: 1, scale: 1 },
            transition: { duration: 0.4, delay: 0.3 }
        });
    </script>
</body>
</html>